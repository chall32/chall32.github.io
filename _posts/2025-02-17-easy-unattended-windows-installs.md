---
layout: post
title: "Unattended Windows Installations Made Easy"
excerpt: "Say Goodbye to Tedious XML Files and Hello to Effortless Installations"
tags: 
- Nutanix
- Windows
image:
  thumb: easy-unattended-windows-installs/easy-unattended-windows-installs-01.png
comments: true
date: 2025-02-17T00:00:00+00:00
---
<img style="float: right; margin: 0px 0px 10px 10px;" alt="Tools Out!" src="/images/easy-unattended-windows-installs/easy-unattended-windows-installs-01.png">
Following on from my [Injecting Drivers into Windows Server 2025 Installer](/injecting-drivers-windows-server-2025-installer/){:target="_blank"} post where we injected Nutanix drivers into the Windows Server 2025 installation media, what else can be done to simplify the creation of a Windows Server 2025 virtual machine?

Sure we can create a Windows Server VM template (the documentation for which is here: [VM Template Management](https://portal.nutanix.com/page/documents/details?targetId=AHV-Admin-Guide-v10_0:mul-vm-template-create-manage-pc-c.html){:target="_blank"}), however we will still need to create a VM from which we can create our template.

So why not simplify the creation of the template and subsequent VM creations from the template with a Windows installation unattended file?

{% include _toc.html %}
## The Problem: Windows Unattended Files are Painful
The Windows unattended installation answer file takes the format of an .xml file. For those unfamiliar with .xml files, they look like this:

<img style="display: block; margin-left: auto; margin-right: auto;" alt="For Example" src="/images/easy-unattended-windows-installs/easy-unattended-windows-installs-02.png">

Yep, not the easiest file format to create and modify by hand. Whats more, troubleshooting is a severe pain in the rear. 

There must be a better way?!?

## The Solution: Windows Answer File Generator
Introducing [Windows Answer File Generator](https://github.com/SvenGroot/GenerateAnswerFile){:target="_blank"} from [Sven Groot on GitHub](https://github.com/SvenGroot){:target="_blank"}.

To quote Sven's GitHub page:

> The Answer File Generator is a command line application and library for generating answer files for unattended Windows installations. These files are commonly called unattend.xml or autounattend.xml (depending on the installation method used).
> 
> This tool can be used to generate answer files as part of an automated workflow for installing Windows, or just as a convenient way to generate answer files for personal use, without the need to install the Windows System Image Manager, or manually edit XML files.
> 
> Answer files can customize many aspects of the Windows installation, only some of which are available through this tool. Customizations supported by the Answer File Generator include:
> 
> - The installation method, partition layout, and target disk and partition.
> - Enabling optional features during installation.
> - Creation of local user accounts.
> - Joining a domain, and adding domain accounts to a local security group.
> - Configuring automatic log-on.
> - The product key, computer name, language/culture, and time zone.
> - Display resolution.
> - Disabling Windows Defender.
> - Enabling remote desktop access.
> - Running PowerShell scripts and other commands on first log-on.
> - Answer files generated by this application will always skip the entire OOBE experience, unless no local account was created and no domain was joined.

For me, it's the pure simplicity in running Sven's Answer File Generator application that has me hooked. The fact that options are supplied in the form of commandline switches is what makes this a killer application for creating Windows unattended files. 

Grab your copy now from the [releases page](https://github.com/SvenGroot/GenerateAnswerFile/releases){:target="_blank"} and don't forget to star Sven's repository whilst you are there! :star:

## Examples 
For example, lets create a Windows Server 2025 autounattend.xml file that includes the following options:

1. Install a 64 bit version of Windows on the first disk of a UEFI system, using the Windows default UEFI partition layout
2. Use UK GMT TimeZone
3. Stop Windows Server Manager from popping up at logon
4. Enable Remote Desktop server for remote admin access
5. Set Computer Name to SERVER-2025

Simple:
{% highlight powershell %}
.\GenerateAnswerFile-2.0.0-x64.exe `
-Install CleanEfi `
-TimeZone "GMT Standard Time" `
-DisableServerManager `
-EnableRemoteDesktop `
-ComputerName "SERVER-2025" `
-OutputFile autounattend.xml
{% endhighlight %}
I've used backticks (``` ` ```) in the above to line wrap the command options making them easier to read. The above (including backticks) can be run as is from the PowerShell command line.

When run and the autounattend.xml opened in notepad (I won't include the whole autounattend.xml, but you get the idea):

<img style="display: block; margin-left: auto; margin-right: auto;" alt="For Example" src="/images/easy-unattended-windows-installs/easy-unattended-windows-installs-03.png">

Some other options that jump immediately to mind:

{% highlight powershell %}
-ProductKey   = Product key used to select what edition to install, and to activate Windows
-ImageIndex   = The index of the image in the WIM file to install. Used editions not installed using a product key (eg evaluation)
-JoinDomain   = Name of a domain to join. Used with appropriate username + password
-LocalAccount = Local account to create, using the format group:name,password or name,password
{% endhighlight %}

Many other options are available, see Sven's documentation: [Windows Answer File Generator Command line arguments](https://github.com/SvenGroot/GenerateAnswerFile/blob/main/doc/CommandLine.md){:target="_blank"}.

## Testing
As usual, I'm going to use the Windows Server 2025 evaluation version available from:

- [https://go.microsoft.com/fwlink/p/?LinkID=2268694&clcid=0x409&culture=en-us&country=US](https://go.microsoft.com/fwlink/p/?LinkID=2268694&clcid=0x409&culture=en-us&country=US){:target="_blank"}<br>(direct download from Microsoft)

I'll be installing into a Nutanix VM, so I'll follow my own post: 
- [Injecting Drivers into Windows Server 2025 Installer](/injecting-drivers-windows-server-2025-installer/){:target="_blank"} 

because I want this to be a "hands off installation".

I'll create my autounattend.xml to install Server 2025 standard with desktop evaluation using the following:
{% highlight powershell %}
.\GenerateAnswerFile-2.0.0-x64.exe `
-Install CleanEfi `
-ImageIndex 2 `
-TimeZone "GMT Standard Time" `
-DisableServerManager `
-EnableRemoteDesktop `
-ComputerName "SERVER-2025" `
-LocalAccount "Administrator,Password123!" `
-OutputFile autounattend.xml
{% endhighlight %}

I have uploaded a copy of the generated autounattend.xml [HERE](/documents/autounattend.xml){:target="_blank"} for your perusal.

Lets test. In Nutanix Prism Element (the same functionality is present in Prism Central), I'll create a VM as normal and I'll supply my generated autounattend.xml file:

<img style="display: block; margin-left: auto; margin-right: auto;" alt="Add Unattended" src="/images/easy-unattended-windows-installs/easy-unattended-windows-installs-04.png">

Save and lets go:

<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/JoyRRFAM474?si=O58kLf5fsaRjedQR" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

*Let my sensual voice sooth your ears!*

-Chris