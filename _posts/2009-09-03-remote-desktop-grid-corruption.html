---
comments: true
layout: post
title: Remote Desktop Grid Corruption
date: '2009-09-03T19:24:00.012+01:00'
tags:
- XP
- RDP
- Windows 7
modified_time: '2009-09-04T17:32:24.306+01:00'
thumbnail: http://4.bp.blogspot.com/_2xKZgKYJlJs/SqAFiaOwNrI/AAAAAAAAAIY/DX5c78lm54A/s72-c/Corruption.PNG
blogger_id: tag:blogger.com,1999:blog-1308168280960455064.post-4764556198012724048
blogger_orig_url: http://chall32.blogspot.com/2009/09/remote-desktop-grid-corruption.html
---

<div class="separator" style="clear: both; font-family: Arial,Helvetica,sans-serif; text-align: left;">Recently when using MS Remote Desktop (aka RDP) I've started to notice this kind of screen corruption:&nbsp;&nbsp;</div><div class="separator" style="clear: both; font-family: Arial,Helvetica,sans-serif; text-align: left;"></div><div class="separator" style="clear: both; font-family: Arial,Helvetica,sans-serif; text-align: center;"><a href="http://4.bp.blogspot.com/_2xKZgKYJlJs/SqAFiaOwNrI/AAAAAAAAAIY/DX5c78lm54A/s1600-h/Corruption.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_2xKZgKYJlJs/SqAFiaOwNrI/AAAAAAAAAIY/DX5c78lm54A/s320/Corruption.PNG" /></a></div><div style="font-family: Arial,Helvetica,sans-serif;"></div><div style="font-family: Arial,Helvetica,sans-serif;">Weird grid lines, "noise" type artefacts and general randomness. </div><div style="font-family: Arial,Helvetica,sans-serif;"></div><div style="font-family: Arial,Helvetica,sans-serif;">Specifically, I'm using RDP Client v5.1 (Win XP SP2) to connect to a server running MS RDP v5.2 (Win 2003 SP2).<br /><br />A quick look around has revealed that the recently released and installed MS Security Patch <a href="http://www.microsoft.com/technet/security/bulletin/MS09-044.mspx"target="_blank">MS09-044</a> has caused this problem.&nbsp; At this point I don't know if it's caused by the server or the client patch. Chalk another one up to quality testing... or not.</div><div style="font-family: Arial,Helvetica,sans-serif;"><br /><b>Resolution</b><br />In typical MS style, the fix is to install the latest RDP client.&nbsp; (lol you didn't expect yet another patch did you?).&nbsp; The latest version is Windows XP RDP Client v6.1 - 1.6Mb - Download from <a href="http://www.microsoft.com/Downloads/details.aspx?familyid=6E1EC93D-BDBD-4983-92F7-479E088570AD&amp;displaylang=en"target="_blank">here</a> <br /><br />However, there doesn't appear to be a v6.1 client for Server 2003.&nbsp; The latest version available is v6.0.&nbsp; For many users and admins this is not an issue, but for those using Terminal Services on a Windows Server 2008 it raises a few issues when using some of the more advanced features of 2008 remote desktop.</div><div style="font-family: Arial,Helvetica,sans-serif;"><br />See <a href="http://blogs.msdn.com/rds/archive/2008/06/25/remote-desktop-connection-terminal-services-client-6-1-for-windows-xp-sp2-x86-platforms.aspx"target="_blank">here</a> for detail about v6.1, and it's new features over v6.0&nbsp;&nbsp; Also notice the loads of comments re v6.1 not being avaialble for Win 2003...<br /><br /><b>Fix: </b>No problem.&nbsp; Download the above and install it on 2003 Server in compatibility mode:</div><ul style="font-family: Arial,Helvetica,sans-serif;"><li>Right-Click the installer</li><li>Select Properties</li><li>Check the "Enable Compatibility box"</li><li>Select "Windows XP"</li><li>Apply and Close </li></ul><div style="font-family: Arial,Helvetica,sans-serif;">Run the installer â€“ follow the prompts and complete the installation<b>.</b><br /><br /><b>Bleedin-edge </b></div><div style="font-family: Arial,Helvetica,sans-serif;">If you want to be on the bleeding edge RDP wise, then you can always use the RDP client from Windows 7. This has the advantage of being able to use all the very latest bells and whistles when connecting to Windows 7 / Windows 2008 servers.<br /><br />See <a href="http://www.neowin.net/news/main/09/03/16/windows-7-rdp-changes-improve-virtual-desktop-performance"target="_blank">here</a> for details of the latest features and screenshots.<br /><br />Getting the Win7 client running on XP is a doodle.&nbsp; Simply copy the following files from Windows 7 Release Candidate [Not got my hands on a RTM yet] to a folder on XP:</div><ul style="font-family: Arial,Helvetica,sans-serif;"><li>mstsc.exe</li><li>mstsc.exe.mui</li><li>mstscax.dll</li><li>mstscax.dll.mui</li></ul><span style="font-family: Arial,Helvetica,sans-serif;">Works fine for me:</span><br /><div style="font-family: Arial,Helvetica,sans-serif;"></div><div class="separator" style="clear: both; font-family: Arial,Helvetica,sans-serif; text-align: center;"></div><div style="font-family: Arial,Helvetica,sans-serif;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_2xKZgKYJlJs/SqAKGlPWXLI/AAAAAAAAAIo/sF8NikMp2cA/s1600-h/Win7RDP-XP.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_2xKZgKYJlJs/SqAKGlPWXLI/AAAAAAAAAIo/sF8NikMp2cA/s320/Win7RDP-XP.PNG" /></a></div><br />Also seems a bit quicker!<br /><br />- Chris </div><div style="font-family: Arial,Helvetica,sans-serif;"></div><div class="blogger-post-footer"><p>

