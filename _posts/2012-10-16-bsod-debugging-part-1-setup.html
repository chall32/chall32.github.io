---
layout: post
title: ! 'BSOD Debugging Part 1: Setup'
date: '2012-10-16T17:59:00.000+01:00'
tags:
- XP
- Windows 2008
- Remote Support
- Windows 7
modified_time: '2012-10-23T17:20:13.848+01:00'
thumbnail: https://lh3.ggpht.com/-jnFU2TCRsJ0/UH10HffLkaI/AAAAAAAABQo/f-d9QSGyNFg/s72-c/BSOD.jpg
blogger_id: tag:blogger.com,1999:blog-1308168280960455064.post-2043327666489027978
blogger_orig_url: http://chall32.blogspot.com/2012/10/bsod-debugging-part-1-setup.html
---

<div class="ssmainhide"><a href="http://3.bp.blogspot.com/-jnFU2TCRsJ0/UH10HffLkaI/AAAAAAAABQo/f-d9QSGyNFg/s1600/BSOD.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://lh3.ggpht.com/-jnFU2TCRsJ0/UH10HffLkaI/AAAAAAAABQo/f-d9QSGyNFg/s1600/BSOD.jpg" /></a></div>By now I'm sure we are all familiar with the humble Windows 'Blue Screen Of Death' (BSOD), displayed when windows crashes. No? Strange as they do tend to pop up in the most unlikely places.&nbsp; Have a look at these examples (click for larger images):<br /><br /><table><tbody><tr><td style="text-align: center;"><a href="http://www.flickr.com/photos/clefty/4699762475/" imageanchor="1" style="margin-left: 0em; margin-right: 0em;"><img border="0" src="https://lh3.ggpht.com/-Tl1kT4OumRU/T6I_zSO_fSI/AAAAAAAABJg/wmb6swcF_W0/s1600/gatwick.jpg" /></a><br /><div><span style="font-size: x-small;">Pic: <a href="http://www.flickr.com/photos/clefty/4699762475/" target="_blank">Clefty</a></span></div></td><td style="text-align: center;"><a href="http://www.flickr.com/photos/stevenh/5834934686/" imageanchor="1" style="margin-left: 0em; margin-right: 0em;"><img border="0" src="https://lh3.ggpht.com/-PXn_5j7x8yw/T6JDgcG46bI/AAAAAAAABJ4/hNs-8Iw60yU/s1600/shopping.jpg" /></a><br /><div><span style="font-size: x-small;">Pic: <a href="http://www.flickr.com/photos/stevenh/5834934686/" target="_blank">Steve Hoang</a></span></div></td><td style="text-align: center;"><a href="http://www.flickr.com/photos/renaissancechambara/3586359959/" imageanchor="1" style="margin-left: 0em; margin-right: 0em;"><img border="0" src="https://lh3.ggpht.com/-3z7WAXeL5pI/T6JB58xBuMI/AAAAAAAABJw/1RoAVw6Z0eI/s1600/samsung.jpg" /></a><br /><div><span style="font-size: x-small;">Pic: <a href="http://www.flickr.com/photos/renaissancechambara/3586359959/" target="_blank">Ged Carroll</a></span></div></td></tr></tbody></table><br />Absolutely anywhere!!!<br /><br />So what can be done to get to the bottom of these BSOD's, how can Windows be fixed so as not to suffer another BSOD in the future?&nbsp; Simple.&nbsp; Use debugging tools for Windows.&nbsp; Here is how.<br /><h2>Capturing a Memory Dump File </h2>First off, you are going to need to capture a memory dump file from the BSOD. A complete memory dump records all the contents of system memory when the system stops unexpectedly. A complete memory dump may contain data from processes that were running when the memory dump was collected.&nbsp; Here is how to configure Windows to dump it's memory to disk:<br /><ul><li><b>Windows 2000/2003/XP</b>: Right-click the My Computer icon, click Properties and then click the Advanced tab. In the Startup and Recovery section, click the Settings... button.</li></ul><ul><li><b>Windows Vista/Windows 7/Windows 8</b>: Right-click the Computer icon, click Properties and then click the Advanced system settings link on the left pane. Click the Advanced tab and in the Startup and Recovery section, click the Settings... button.</li></ul>From the drop-down menu in the Write debugging information section, you can select one of the following options:<br /><ul><li><b>Small memory dump </b>– 64 KB in size, records the most important information about the problem</li></ul><ul><li><b>Kernel memory dump</b> – A complete record of system memory; creates files at the size of the operating memory</li></ul>Here is my setting: <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-6_2Hpze-g_A/UH1ERdbwj6I/AAAAAAAABO8/z8XjJhqoZ8Y/s1600/debug0.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh3.ggpht.com/-6_2Hpze-g_A/UH1ERdbwj6I/AAAAAAAABO8/z8XjJhqoZ8Y/s1600/debug0.jpg" width="272" /></a></div><br />All you need to do now is wait for your system to crash again!<br /><br />OK, so you've created your MEMORY.DMP dump file.&nbsp; Now we need to examine it using the Microsoft Debugging Tools for Windows.<br /><h2>Installing Debugging Tools for Windows</h2>First off, you do not need to install the debugging tools on the system that is having the BSOD problem. Use another system if possible.&nbsp; The system will need to have around 200Mb free disk space&nbsp; and be able to access the internet.<br /><br />Microsoft, in their wisdom, have decided to bundle the debugging tools in with their Windows Software Development Kits (SDK).&nbsp; But have no fear, we don't have to download the whole SDK!<br /><br />But before we can get to the SDK, we first have to install MS .NET Framework 4.5. Grab the Web installer or Offline installer from <a href="http://msdn.microsoft.com/en-us/library/5a4x27ek.aspx" target="_blank">here (Microsoft)</a> <br /><br />Once you have .NET 4.5 installed, you can go ahead and grab the Windows 8 SDK installer from <a href="http://msdn.microsoft.com/en-us/windows/hardware/hh852363" target="_blank">here (Microsoft)</a> <br /><br />Launch the SDK installer, and choose "Install to this computer":<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-VijYJ8LiKU8/UH1kXLVs-2I/AAAAAAAABPQ/hqilApaJdeg/s1600/debug1.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="https://lh3.ggpht.com/-VijYJ8LiKU8/UH1kXLVs-2I/AAAAAAAABPQ/hqilApaJdeg/s1600/debug1.jpg" width="320" /></a></div><br />Choose whether to join CEIP: <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-8vN0Qgqd98s/UH1kseFYrjI/AAAAAAAABPY/_SFime7iNPI/s1600/debug2.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="https://lh3.ggpht.com/-8vN0Qgqd98s/UH1kseFYrjI/AAAAAAAABPY/_SFime7iNPI/s1600/debug2.jpg" width="320" /></a></div><br />Accept the license agreement. Now select ONLY "Debugging Tools for Windows" and click Install:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-D_Rz0fCnops/UH1lX-Ah55I/AAAAAAAABPg/WKFNKE6TS7s/s1600/debug5.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="https://lh3.ggpht.com/-D_Rz0fCnops/UH1lX-Ah55I/AAAAAAAABPg/WKFNKE6TS7s/s1600/debug5.jpg" width="320" /></a></div><br />Once installation is complete, click Close to finish.<br /><h3>Using the Windows Debugging Tools</h3>Windows Debugging tools will buried away in your start menu under "Windows Kits":<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-__Bwy8iJY3U/UH1mk7A3jEI/AAAAAAAABPo/S5zEcyUOas8/s1600/WinKits.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://lh3.ggpht.com/-__Bwy8iJY3U/UH1mk7A3jEI/AAAAAAAABPo/S5zEcyUOas8/s1600/WinKits.jpg" /></a></div><br />Don't worry if you only have X86 version installed.&nbsp; This version will debug 64bit crash dumps without issue.&nbsp; The program you are looking to run is <b>WinDbg(x64)</b> or <b>WinDbg(x86)</b> <br /><br />Next you need to set the debugging symbol file path:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-uPPXU9XJ6N0/UH1qbUirLBI/AAAAAAAABP8/7Iy9WI666X4/s1600/debug8.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh3.ggpht.com/-uPPXU9XJ6N0/UH1qbUirLBI/AAAAAAAABP8/7Iy9WI666X4/s1600/debug8.jpg" width="159" /></a></div><br />Whats a debugging symbol?&nbsp; <a href="https://en.wikipedia.org/wiki/Debug_symbol" target="_blank">Here you go (Wikipedia)</a>. We need to set the debugger to use Microsoft's very own symbols server and cache them locally in C:\Symbols. This is entered as follows:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-7-Ic-ZdShDE/UH1rrinxCVI/AAAAAAAABQE/w2F13rZgPt0/s1600/debug9.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="120" src="https://lh3.ggpht.com/-7-Ic-ZdShDE/UH1rrinxCVI/AAAAAAAABQE/w2F13rZgPt0/s1600/debug9.jpg" width="320" /></a></div>The text entered is:<br /><br /><div style="text-align: center;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">SRV*c:\Symbols*http://msdl.microsoft.com/download/symbols</span></div><div style="text-align: center;"><br /></div>Click OK, then click File - Save Workspace to save.&nbsp; Open Windows explorer and create a new folder in the root of C:\ called Symbols:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-C7mbXfONwg0/UH1tllL_z8I/AAAAAAAABQM/ZsTqCv3gHvc/s1600/csymbols.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="178" src="https://lh3.ggpht.com/-C7mbXfONwg0/UH1tllL_z8I/AAAAAAAABQM/ZsTqCv3gHvc/s1600/csymbols.jpg" width="320" /></a></div><br />That is it for this part folks.<br /><br />You have your MEMORY.DMP dump file and you have setup your Windows debugging environment.&nbsp; Carry on to part 2: Debugging available <a href="http://chall32.blogspot.co.uk/2012/10/bsod-debugging-part-2-debugging.html">here</a><br /><br />- Chris<div class="blogger-post-footer"><p>

