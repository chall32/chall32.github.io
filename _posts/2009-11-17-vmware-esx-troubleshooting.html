---
layout: post
title: VMware ESX Trouble Shooting
date: '2009-11-17T14:11:00.008Z'
tags:
- ESXi
- VMware
- ESX
modified_time: '2010-07-26T00:42:11.642+01:00'
thumbnail: http://2.bp.blogspot.com/_2xKZgKYJlJs/SwFvU69vy1I/AAAAAAAAATk/LzUEIsJqj7I/s72-c/vmware-logo.jpg
blogger_id: tag:blogger.com,1999:blog-1308168280960455064.post-4763090089449279140
blogger_orig_url: http://chall32.blogspot.com/2009/11/vmware-esx-troubleshooting.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_2xKZgKYJlJs/SwFvU69vy1I/AAAAAAAAATk/LzUEIsJqj7I/s1600/vmware-logo.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/_2xKZgKYJlJs/SwFvU69vy1I/AAAAAAAAATk/LzUEIsJqj7I/s320/vmware-logo.jpg" /></a></div>Just recently I've had cause to analyse some VMware ESX logs in a bid to understand what was going on with a problematic ESX server and just what could be done to remedy the situation.<br /><br />Up until now I hadn't given ESX logging much thought, mainly easing my conscience by thinking "Yea I'm sure ESX keeps a log of everything somewhere. It's Linux after all..!"<br /><br />Well as I've discovered, its no longer time to keep parts of me buried in the sand, it's time to get looking at these logs.&nbsp; After all they are there to help (I think) and with a bit of prior knowledge you too can start to understand "ESX log speak".<br /><br />The first thing to realise with ESX logs is that there aren't just three (like Windows) there are in fact twelve!<br /><br /><b><span style="font-size: large;">Obtaining ESX Log Bundles</span></b><br />Rather than go delving around on a live ESX server, lets get the copies of the logs downloaded locally so that we can analyse them at our leisure.<br /><br />Using the Virtual Infrastructure (VI) Client this is quite a simple thing to do:<br /><ol><li>Logon to your Virtual Center or your ESX host directly</li><li>File - Export - Export Diagnostic Data</li><li>Select your ESX host, whether you wish to include Virtual Center Server and VI Client Logs and where you wish to download the logs to<br /></li></ol>Now just sit back and wait - it can take a while for the logs to be generated and downloaded.<br /><br /><b><span style="font-size: large;">Viewing the ESX Log Bundles</span></b><br />Now I'm sure that there are other ways to do this, but the method I find easiest is to use <a href="http://www.rarlab.com/" target="_blank">WinRAR</a>.&nbsp; Two reasons:<br /><ol><li>WinRAR can open .tgz compressed files</li><li>WinRAR's view function properly displays the log files are in a readable format. &nbsp;- The only other to way view the log files in Windows is to open the files with Wordpad&nbsp;</li></ol>I don't normally bother extracting the .tgz bundle file, I just use the view function in WinRAR to show me the contents of the log files.<br /><br /><b><span style="font-size: large;">Which Log is Which?</span></b><br />OK on to the 'meat and potatoes' of this post.&nbsp; Here is a break down of what is logged in each ESX log file. <br /><br /><table border="1" cellpadding="4"><tbody><tr align="left"><td><span style="font-size: large;"><b>Log File</b></span></td> <td><span style="font-size: large;"><b>Name</b></span></td> <td><span style="font-size: large;"><b>Details</b></span></td> </tr><tr align="left"> <td>/var/log/vmkernel</td> <td>Vmkernel</td> <td>Records activities related to the virtual machines and ESX host [1]</td> </tr><tr align="left"> <td>/var/log/vmkwarning</td> <td>Vmkernel Warnings</td> <td>A copy of everything marked as a warning or higher severity from vmkernel log. Easier to look through than vmkernel log [1]</td> </tr><tr align="left"> <td>/var/log/vmksummary</td> <td>Vmkernel Summary</td> <td>Used for avaialability and uptime statistics. Human-readable summary in vmksummary.txt</td> </tr><tr align="left"> <td>/var/log/vmware/hostd.log</td> <td>Host Agent Log</td> <td>Contains information on the agent that manages and configures the ESX host and its virtual machines</td> </tr><tr align="left"> <td>/var/log/vmware/vpx</td> <td>VirtualCenter Agent</td> <td>Contains information on the agent that communicates with VirtualCenter</td> </tr><tr align="left"> <td>/var/log/messages</td> <td>Service Console</td> <td>Log from the Linux kernel.  Useful for underlying Linux issues. The kernel has no awareness of VMs running on the VMkernel [2]</td> </tr><tr align="left"> <td>/var/log/vmware/esxcfg-boot.log</td> <td>ESX Boot Log</td> <td>ESX Boot log, logs all ESX boot events [2]</td> </tr><tr align="left"> <td>/var/log/vmware/webAccess</td> <td>Web Access</td> <td>Records information on Web-based access to ESX Server</td> </tr><tr align="left"> <td>/var/log/secure</td> <td>Authentication Log</td> <td>Contains records of connections that require authentication, such as VMware daemons and actions initiated by the xinetd daemon</td> </tr><tr align="left"> <td>/var/log/vmware/esxcfg-firewall.log</td> <td>ESX Firewall Log</td> <td>Contains all firewall rule events [1]</td> </tr><tr align="left"> <td>/var/log/vmware/aam</td> <td>High Availability Log</td> <td>Contains information related to the High Availability (HA) service</td> </tr><tr align="left"> <td>/var/log/vmware/esxupdate.log</td> <td>ESX Update Log</td> <td>Logs all updates completed using the esxupdate tool</td> </tr></tbody></table><br /><b>NOTES:</b><br />[1] Logs rotated by logrotate, see <a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=3402740" target="_blank">KB3402740</a>. Rotated with a numeric extension, current log has no extension and the next newest one has a .1 extension.<br />[2] Log is symbollically linked to the current real file. Run an 'ls -l logname.log' to see the link.<br /><br /><div style="margin: 0px;"><b><span style="font-size: large;">What to Look For</span></b></div>This really depends on the error you are trying to troubleshoot!<br /><br />A good starter for ten is to search for the text "error" in any of the logs ;o)<br /><br /><b><span style="font-size: large;">Further Information</span></b><br />Additional Reading:<br /><ul><li>VI3 Advanced Log Analysis - <a href="http://vmetc.com/wp-content/plugins/download-monitor/download.php?id=12" target="_blank">Powerpoint</a></li><li>Troubleshooting VMware ESX Server 3and VMware VirtualCenter 2 - <a href="http://download3.vmware.com/vmworld/2006/mdc9694.pdf" target="_blank">PDF</a></li><li>Tips for Troubleshooting VMware ESX Server Faults -&nbsp;<a href="http://download3.vmware.com/vmworld/2006/tac0028.pdf" target="_blank">PDF</a></li><li>ESX Server 3 Log Map - <a href="http://viops.vmware.com/home/docs/DOC-1451" target="_blank">link</a></li><li>Which ESX Log File - <a href="http://www.vmwarewolf.com/which-esx-log-file/" target="_blank">link</a></li></ul>VMware Lab Presentation Videos:<br /><ul><li>Tips for Troubleshooting ESX Server 3.x Faults - <a href="http://www.vmworld.com/docs/DOC-2029" target="_blank">Presentation</a> (free VMworld login required to view <br /></li><li>Troubleshooting VI3 - <a href="http://www.vmworld.com/docs/DOC-2087" target="_blank">Presentation</a> (free VMworld login required to view)</li></ul><b><span style="font-size: large;">Conclusion</span></b><br />It's not possible to cover every eventuality in just one blog post.  Hopefully the information provided here will at the very least set you on the right road to resolving ESX issues for yourself.<br /><br />One final thought - All of the ESX issues I've come up against have a logical cause and hence a totally logical solution.&nbsp; There are no smoke and mirrors here.&nbsp; With that in mind, have fun.<br /><br />- Chris<div class="blogger-post-footer"><p>

